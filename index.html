<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Produ√ß√£o de Necessaire</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px;
            background-color: #f5f5f5;
        }
        
        /* RESPONSIVIDADE */
        @media (max-width: 768px) {
            body {
                padding: 5px;
            }
            
            .container {
                padding: 15px;
                margin-bottom: 15px;
            }
            
            h1 {
                font-size: 22px;
                margin-bottom: 20px;
            }
            
            h2 {
                font-size: 18px;
            }
            
            .grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .result-table {
                font-size: 14px;
            }
            
            .result-table th,
            .result-table td {
                padding: 8px 6px;
            }
            
            input[type="number"] {
                width: 80px;
                font-size: 14px;
            }
            
            .calc-button {
                padding: 10px 20px;
                font-size: 14px;
                margin: 5px 0;
                width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            h1 {
                font-size: 20px;
            }
            
            .result-table {
                font-size: 12px;
            }
            
            .result-table th,
            .result-table td {
                padding: 6px 4px;
            }
            
            .cutting-item {
                padding: 6px 10px;
                font-size: 14px;
            }
        }
        
        .container {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        
        h1 {
            color: #2c5530;
            text-align: center;
            margin-bottom: 30px;
            font-size: 28px;
        }
        
        h2 {
            color: #4a7c59;
            border-bottom: 2px solid #4a7c59;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        
        h3 {
            color: #5d8b6a;
            margin-top: 20px;
        }
        
        .input-group {
            margin: 20px 0;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #4a7c59;
        }
        
        label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #2c5530;
        }
        
        input[type="number"] {
            width: 100px;
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        input[type="number"]:focus {
            outline: none;
            border-color: #4a7c59;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .card {
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .result-table th {
            background-color: #4a7c59;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }
        
        .result-table td {
            padding: 10px 12px;
            border-bottom: 1px solid #eee;
        }
        
        .result-table tr:hover {
            background-color: #f8f9fa;
        }
        
        .highlight {
            background-color: #e8f5e8;
            font-weight: bold;
            color: #2c5530;
        }
        
        .total-row {
            background-color: #4a7c59 !important;
            color: white !important;
            font-weight: bold;
        }
        
        .material-section {
            margin: 25px 0;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
            border: 1px solid #dee2e6;
        }
        
        .cutting-map {
            background: #fff;
            border: 2px solid #4a7c59;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        
        .cutting-item {
            background: #e8f5e8;
            padding: 8px 12px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 4px solid #4a7c59;
        }
        
        .calc-button {
            background-color: #4a7c59;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            margin: 10px 5px;
        }
        
        .calc-button:hover {
            background-color: #2c5530;
        }
        
        .print-button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            margin: 15px 5px;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .print-button:hover {
            background-color: #218838;
        }
        
        .print-button:before {
            content: "üñ®Ô∏è";
        }
        
        /* ESTILOS PARA IMPRESS√ÉO */
        @media print {
            body {
                background: white !important;
                font-size: 12pt;
                margin: 0;
                padding: 10px;
            }
            
            .no-print {
                display: none !important;
            }
            
            .container {
                box-shadow: none !important;
                border: none !important;
                margin: 0 !important;
                padding: 0 !important;
                page-break-inside: avoid;
            }
            
            .print-only {
                display: block !important;
            }
            
            .result-table {
                box-shadow: none !important;
                border: 1px solid #333 !important;
            }
            
            .result-table th {
                background-color: #f0f0f0 !important;
                color: #333 !important;
                border: 1px solid #333 !important;
            }
            
            .result-table td {
                border: 1px solid #333 !important;
            }
            
            .cutting-item {
                border: 1px solid #333 !important;
                background: white !important;
            }
            
            .highlight {
                background-color: #f5f5f5 !important;
                color: #000 !important;
            }
            
            h1, h2, h3 {
                color: #000 !important;
            }
        }
        
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üßµ Calculadora de Produ√ß√£o de Necessaire</h1>
        
        <div class="input-group">
            <label for="quantity">Quantidade de Necessaires a Produzir:</label>
            <input type="number" id="quantity" min="1" value="1" onchange="calculateMaterials()">
            <button class="calc-button" onclick="calculateMaterials()">Calcular Materiais</button>
        </div>
    </div>

    <div class="container no-print">
        <h2>üìä Resumo de Materiais Necess√°rios</h2>
        <div id="summary"></div>
    </div>

    <div class="container no-print">
        <h2>üõí Lista de Compras - Materiais Necess√°rios</h2>
        <div style="text-align: center; margin-bottom: 20px;">
            <button class="print-button" onclick="printShoppingList()">Imprimir Lista de Compras</button>
        </div>
        <div id="shopping-list"></div>
    </div>

    <div class="container no-print">
        <h2>‚úÇÔ∏è Mapeamento de Corte Otimizado</h2>
        <div id="cutting-map"></div>
    </div>

    <script>
        // Dados base para 1 necessaire
        const baseData = {
            tecido: [
                {nome: 'Corpo atr√°s', largura: 15, comprimento: 26, quantidade: 1},
                {nome: 'Corpo frente (baixo)', largura: 13, comprimento: 26, quantidade: 1},
                {nome: 'Corpo frente (cima)', largura: 9, comprimento: 26, quantidade: 1},
                {nome: 'Fundo', largura: 14, comprimento: 42, quantidade: 1},
                {nome: 'Faixa de z√≠per', largura: 7, comprimento: 42, quantidade: 2},
                {nome: 'Faixa para vivo', largura: 3, comprimento: 82, quantidade: 2},
                {nome: 'Al√ßa de m√£o (opcional)', largura: 5, comprimento: 25, quantidade: 1},
                {nome: 'Freios z√≠per bolsos', largura: 3, comprimento: 4, quantidade: 8},
                {nome: 'Freios z√≠per fole (opcional)', largura: 5, comprimento: 4, quantidade: 1}
            ],
            forro: [
                {nome: 'Corpo atr√°s', largura: 15, comprimento: 26, quantidade: 3},
                {nome: 'Corpo frente (baixo)', largura: 13, comprimento: 26, quantidade: 1},
                {nome: 'Corpo frente (cima)', largura: 9, comprimento: 26, quantidade: 1},
                {nome: 'Faixa de z√≠per', largura: 7, comprimento: 42, quantidade: 2}
            ],
            tela: [
                {nome: 'Bolso interno 1', largura: 12, comprimento: 26, quantidade: 1},
                {nome: 'Bolso interno 2', largura: 3, comprimento: 26, quantidade: 1},
                {nome: 'Bolso interno 3', largura: 12, comprimento: 26, quantidade: 1}
            ],
            eva: [
                {nome: 'Estrutura principal', largura: 11, comprimento: 22, quantidade: 1},
                {nome: 'Estrutura fundo', largura: 10, comprimento: 38, quantidade: 1},
                {nome: 'Estrutura lateral', largura: 3, comprimento: 38, quantidade: 2}
            ]
        };

        const outros = {
            fecho: 1.0, // metros
            cursor: 4, // pe√ßas
            vies: 2.05, // metros
            cadaco_alca: 0.23, // metros
            puxador: 4, // tirinhas de 0.5x10cm
            cadaco_freio: 0.04 // metros
        };

        function calculateMaterials() {
            const quantity = parseInt(document.getElementById('quantity').value) || 1;
            
            // Calcular necessidades totais
            const results = {
                tecido: calculateFabricNeeds('tecido', quantity),
                forro: calculateFabricNeeds('forro', quantity),
                tela: calculateFabricNeeds('tela', quantity),
                eva: calculateEVANeeds(quantity)
            };

            displaySummary(results, quantity);
            displayShoppingList(results, quantity);
            displayCuttingMap(results, quantity);
        }

        function calculateFabricNeeds(type, quantity) {
            const items = baseData[type];
            const fabricWidth = 140; // cm
            let totalLength = 0;
            let pieces = [];

            items.forEach(item => {
                const totalPieces = item.quantidade * quantity;
                pieces.push({
                    ...item,
                    totalQuantidade: totalPieces,
                    areaTotal: item.largura * item.comprimento * totalPieces
                });
            });

            // Calcular aproveitamento otimizado
            const layout = optimizeLayout(pieces, fabricWidth);
            totalLength = layout.totalLength;

            // Adicionar margem de seguran√ßa de 8%
            const finalLength = Math.ceil(totalLength * 1.08);

            return {
                pieces: pieces,
                totalLength: totalLength,
                finalLength: finalLength,
                finalMeters: (finalLength / 100).toFixed(2),
                layout: layout
            };
        }

        function calculateEVANeeds(quantity) {
            const items = baseData.eva;
            const evaWidth = 130; // cm
            let pieces = [];

            items.forEach(item => {
                const totalPieces = item.quantidade * quantity;
                pieces.push({
                    ...item,
                    totalQuantidade: totalPieces,
                    areaTotal: item.largura * item.comprimento * totalPieces
                });
            });

            const layout = optimizeLayout(pieces, evaWidth);
            const finalLength = Math.ceil(layout.totalLength * 1.08);

            return {
                pieces: pieces,
                totalLength: layout.totalLength,
                finalLength: finalLength,
                finalMeters: (finalLength / 100).toFixed(2),
                layout: layout
            };
        }

        function optimizeLayout(pieces, fabricWidth) {
            let currentRow = [];
            let currentRowWidth = 0;
            let currentRowHeight = 0;
            let totalHeight = 0;
            let rows = [];

            // Ordenar pe√ßas por altura decrescente para melhor aproveitamento
            const sortedPieces = [...pieces].sort((a, b) => b.comprimento - a.comprimento);

            sortedPieces.forEach(piece => {
                for (let i = 0; i < piece.totalQuantidade; i++) {
                    if (currentRowWidth + piece.largura <= fabricWidth) {
                        // Cabe na linha atual
                        currentRow.push({...piece, index: i + 1});
                        currentRowWidth += piece.largura;
                        currentRowHeight = Math.max(currentRowHeight, piece.comprimento);
                    } else {
                        // Nova linha
                        if (currentRow.length > 0) {
                            rows.push({
                                pieces: [...currentRow],
                                width: currentRowWidth,
                                height: currentRowHeight
                            });
                            totalHeight += currentRowHeight;
                        }
                        currentRow = [{...piece, index: i + 1}];
                        currentRowWidth = piece.largura;
                        currentRowHeight = piece.comprimento;
                    }
                }
            });

            // Adicionar √∫ltima linha
            if (currentRow.length > 0) {
                rows.push({
                    pieces: [...currentRow],
                    width: currentRowWidth,
                    height: currentRowHeight
                });
                totalHeight += currentRowHeight;
            }

            return {
                rows: rows,
                totalLength: totalHeight,
                efficiency: calculateEfficiency(pieces, fabricWidth, totalHeight)
            };
        }

        function calculateEfficiency(pieces, width, height) {
            const totalArea = pieces.reduce((sum, piece) => sum + (piece.areaTotal || 0), 0);
            const usedArea = width * height;
            return usedArea > 0 ? ((totalArea / usedArea) * 100).toFixed(1) : 0;
        }

        function displaySummary(results, quantity) {
            const summaryDiv = document.getElementById('summary');
            
            const html = `
                <table class="result-table">
                    <thead>
                        <tr>
                            <th>Material</th>
                            <th>Metragem Necess√°ria</th>
                            <th>Com Margem (8%)</th>
                            <th>Aproveitamento</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Tecido Principal</td>
                            <td>${(results.tecido.totalLength/100).toFixed(2)}m</td>
                            <td class="highlight">${results.tecido.finalMeters}m</td>
                            <td>${results.tecido.layout.efficiency}%</td>
                        </tr>
                        <tr>
                            <td>Forro</td>
                            <td>${(results.forro.totalLength/100).toFixed(2)}m</td>
                            <td class="highlight">${results.forro.finalMeters}m</td>
                            <td>${results.forro.layout.efficiency}%</td>
                        </tr>
                        <tr>
                            <td>Tela Voley</td>
                            <td>${(results.tela.totalLength/100).toFixed(2)}m</td>
                            <td class="highlight">${results.tela.finalMeters}m</td>
                            <td>${results.tela.layout.efficiency}%</td>
                        </tr>
                        <tr>
                            <td>EVA</td>
                            <td>${(results.eva.totalLength/100).toFixed(2)}m</td>
                            <td class="highlight">${results.eva.finalMeters}m</td>
                            <td>${results.eva.layout.efficiency}%</td>
                        </tr>
                    </tbody>
                </table>

                <h3>Outros Materiais (para ${quantity} necessaire${quantity > 1 ? 's' : ''})</h3>
                <table class="result-table">
                    <tbody>
                        <tr><td>Fecho n¬∫5</td><td class="highlight">${(outros.fecho * quantity).toFixed(2)}m</td></tr>
                        <tr><td>Cursores (carrinhos)</td><td class="highlight">${outros.cursor * quantity} pe√ßas</td></tr>
                        <tr><td>Vi√©s</td><td class="highlight">${(outros.vies * quantity).toFixed(2)}m</td></tr>
                        <tr><td>Cadar√ßo para al√ßa</td><td class="highlight">${(outros.cadaco_alca * quantity).toFixed(2)}m</td></tr>
                        <tr><td>Puxadores (tirinhas)</td><td class="highlight">${outros.puxador * quantity} pe√ßas</td></tr>
                        <tr><td>Cadar√ßo para freios</td><td class="highlight">${(outros.cadaco_freio * quantity).toFixed(2)}m</td></tr>
                    </tbody>
                </table>
            `;
            
            summaryDiv.innerHTML = html;
        }

        function displayShoppingList(results, quantity) {
            const shoppingDiv = document.getElementById('shopping-list');
            
            const html = `
                <div class="grid">
                    <div class="card">
                        <h3>üßµ TECIDOS E MATERIAIS PRINCIPAIS</h3>
                        <table class="result-table">
                            <thead>
                                <tr>
                                    <th>Material</th>
                                    <th>Quantidade</th>
                                    <th>Especifica√ß√£o</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>Tecido Principal</strong></td>
                                    <td class="highlight">${results.tecido.finalMeters}m</td>
                                    <td>Largura: 1,40m (qualquer tecido de sua prefer√™ncia)</td>
                                </tr>
                                <tr>
                                    <td><strong>Tecido para Forro</strong></td>
                                    <td class="highlight">${results.forro.finalMeters}m</td>
                                    <td>Largura: 1,40m (algod√£o cru ou similar)</td>
                                </tr>
                                <tr>
                                    <td><strong>Tela Voley</strong></td>
                                    <td class="highlight">${results.tela.finalMeters}m</td>
                                    <td>Largura: 1,40m (para bolsos internos)</td>
                                </tr>
                                <tr>
                                    <td><strong>EVA para Estrutura</strong></td>
                                    <td class="highlight">${results.eva.finalMeters}m</td>
                                    <td>Largura: 1,30m (espessura: 2-3mm)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="card">
                        <h3>üß∑ AVIAMENTOS E ACESS√ìRIOS</h3>
                        <table class="result-table">
                            <tbody>
                                <tr>
                                    <td><strong>Z√≠per n¬∫5</strong></td>
                                    <td class="highlight">${(outros.fecho * quantity).toFixed(2)}m</td>
                                    <td>Qualquer cor de sua prefer√™ncia</td>
                                </tr>
                                <tr>
                                    <td><strong>Cursores para Z√≠per</strong></td>
                                    <td class="highlight">${outros.cursor * quantity} unidades</td>
                                    <td>Carrinhos n¬∫5, mesma cor do z√≠per</td>
                                </tr>
                                <tr>
                                    <td><strong>Vi√©s</strong></td>
                                    <td class="highlight">${(outros.vies * quantity).toFixed(2)}m</td>
                                    <td>Largura: 2cm, cor combinando</td>
                                </tr>
                                <tr>
                                    <td><strong>Vivo para Acabamento</strong></td>
                                    <td class="highlight">Incluso no tecido principal</td>
                                    <td>Espessura: 2,5mm (ser√° coberto com tecido)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="card">
                        <h3>üéÄ COMPLEMENTOS OPCIONAIS</h3>
                        <table class="result-table">
                            <tbody>
                                <tr>
                                    <td><strong>Cadar√ßo para Al√ßa</strong></td>
                                    <td class="highlight">${(outros.cadaco_alca * quantity).toFixed(2)}m</td>
                                    <td>Ou use tecido (j√° incluso na metragem)</td>
                                </tr>
                                <tr>
                                    <td><strong>Material para Puxadores</strong></td>
                                    <td class="highlight">${outros.puxador * quantity} tirinhas</td>
                                    <td>Couro sint√©tico ou tecido (0,5√ó10cm cada)</td>
                                </tr>
                                <tr>
                                    <td><strong>Cadar√ßo para Freios</strong></td>
                                    <td class="highlight">${(outros.cadaco_freio * quantity).toFixed(2)}m</td>
                                    <td>Largura: 30mm ou use tecido (j√° incluso)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="warning">
                    <strong>üí° DICA IMPORTANTE:</strong> Todas as metragens j√° incluem 8% de margem de seguran√ßa. 
                    As especifica√ß√µes de largura s√£o padr√£o do mercado brasileiro.
                </div>

                <div class="material-section" id="printable-checklist">
                    <h3>üìù CHECKLIST PARA COMPRAS - ${quantity} NECESSAIRE${quantity > 1 ? 'S' : ''}</h3>
                    <div class="print-only" style="display: none;">
                        <p><strong>Data:</strong> ___/___/_____ | <strong>Loja:</strong> _________________________</p>
                        <p><strong>Projeto:</strong> Necessaire | <strong>Quantidade:</strong> ${quantity} unidade${quantity > 1 ? 's' : ''}</p>
                        <hr>
                    </div>
                    <div class="grid">
                        <div class="cutting-item">
                            <strong>TECIDOS:</strong><br>
                            ‚òê <strong>${results.tecido.finalMeters}m</strong> de tecido principal (1,40m largura)<br>
                            ‚òê <strong>${results.forro.finalMeters}m</strong> de tecido para forro (1,40m largura)<br>
                            ‚òê <strong>${results.tela.finalMeters}m</strong> de tela voley (1,40m largura)<br>
                            ‚òê <strong>${results.eva.finalMeters}m</strong> de EVA estrutural (1,30m largura)
                        </div>
                        <div class="cutting-item">
                            <strong>AVIAMENTOS:</strong><br>
                            ‚òê <strong>${(outros.fecho * quantity).toFixed(2)}m</strong> de z√≠per n¬∫5<br>
                            ‚òê <strong>${outros.cursor * quantity}</strong> cursores n¬∫5<br>
                            ‚òê <strong>${(outros.vies * quantity).toFixed(2)}m</strong> de vi√©s 2cm<br>
                            ‚òê Vivo 2,5mm (quantidade conforme prefer√™ncia)
                        </div>
                    </div>
                    <div class="print-only" style="display: none; margin-top: 20px;">
                        <p><strong>OBSERVA√á√ïES:</strong></p>
                        <p>‚ñ° Verificar qualidade dos materiais</p>
                        <p>‚ñ° Confirmar larguras dos tecidos</p>
                        <p>‚ñ° Testar compatibilidade de cores</p>
                        <p style="margin-top: 20px;"><strong>TOTAL GASTO:</strong> R$ ___________</p>
                    </div>
                </div>
            `;
            
            shoppingDiv.innerHTML = html;
        }

        function displayCuttingMap(results, quantity) {
            const cuttingDiv = document.getElementById('cutting-map');
            
            let html = '';
            
            Object.keys(results).forEach(materialType => {
                const material = results[materialType];
                const materialName = {
                    'tecido': 'Tecido Principal (140cm largura)',
                    'forro': 'Forro (140cm largura)',
                    'tela': 'Tela Voley (140cm largura)',
                    'eva': 'EVA (130cm largura)'
                }[materialType];

                html += `
                    <div class="cutting-map">
                        <h3>${materialName}</h3>
                        <p><strong>Metragem total:</strong> ${material.finalMeters}m | <strong>Aproveitamento:</strong> ${material.layout.efficiency}%</p>
                `;

                material.layout.rows.forEach((row, index) => {
                    html += `
                        <div class="cutting-item">
                            <strong>Fileira ${index + 1}:</strong> Altura ${row.height}cm | Largura usada: ${row.width}cm<br>
                            Pe√ßas: ${row.pieces.map(p => `${p.nome} (${p.largura}√ó${p.comprimento})`).join(', ')}
                        </div>
                    `;
                });

                html += '</div>';
            });
            
            cuttingDiv.innerHTML = html;
        }

        // Calcular automaticamente ao carregar a p√°gina
        calculateMaterials();

        // Fun√ß√£o para imprimir apenas o checklist
        function printShoppingList() {
            // Ocultar elementos que n√£o devem ser impressos
            const noprint = document.querySelectorAll('.no-print');
            const printonly = document.querySelectorAll('.print-only');
            
            // Criar uma nova janela com apenas o conte√∫do da lista de compras
            const printWindow = window.open('', '_blank', 'width=800,height=600');
            
            const listContent = document.getElementById('shopping-list').innerHTML;
            
            printWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Lista de Compras - Necessaire</title>
                    <style>
                        body { 
                            font-family: Arial, sans-serif; 
                            margin: 20px; 
                            color: #333;
                            background: white;
                        }
                        .grid { 
                            display: grid; 
                            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
                            gap: 20px; 
                            margin: 20px 0; 
                        }
                        .card { 
                            border: 1px solid #ddd; 
                            padding: 15px; 
                            border-radius: 8px;
                            background: white;
                        }
                        .result-table { 
                            width: 100%; 
                            border-collapse: collapse; 
                            margin: 15px 0; 
                            border: 1px solid #333;
                        }
                        .result-table th { 
                            background-color: #f0f0f0; 
                            padding: 10px; 
                            border: 1px solid #333;
                            font-weight: bold;
                        }
                        .result-table td { 
                            padding: 8px 10px; 
                            border: 1px solid #333;
                        }
                        .highlight { 
                            background-color: #f5f5f5; 
                            font-weight: bold; 
                        }
                        .cutting-item { 
                            background: #f8f9fa; 
                            padding: 10px; 
                            margin: 8px 0; 
                            border: 1px solid #333;
                            border-radius: 5px;
                        }
                        .material-section {
                            margin: 20px 0;
                            padding: 15px;
                            border: 1px solid #ddd;
                            border-radius: 8px;
                        }
                        .warning {
                            background-color: #fff3cd;
                            border: 1px solid #ffeaa7;
                            padding: 10px;
                            border-radius: 5px;
                            margin: 15px 0;
                        }
                        .print-only { display: block !important; }
                        h1, h2, h3 { color: #333; margin-top: 0; }
                        hr { border: none; border-top: 2px solid #333; margin: 15px 0; }
                    </style>
                </head>
                <body>
                    <h1>üõí Lista de Compras - Materiais para Necessaire</h1>
                    ${listContent}
                </body>
                </html>
            `);
            
            printWindow.document.close();
            
            // Aguardar carregar e imprimir
            setTimeout(() => {
                printWindow.print();
                printWindow.close();
            }, 500);
        }
    </script>
</body>
</html>
